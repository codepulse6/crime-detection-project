import urllib.request
import urllib.parse
import json
from datetime import datetime

# Twitter API Setup (replace with your actual token)
TWITTER_BEARER_TOKEN = 'your_twitter_bearer_token'

def fetch_twitter_crime_posts(start_year, end_year):
    query = urllib.parse.quote("crime OR theft OR attack OR murder")
    url = f"https://api.twitter.com/2/tweets/search/recent?query={query}&max_results=10"

    headers = {
        "Authorization": f"Bearer {TWITTER_BEARER_TOKEN}"
    }

    request = urllib.request.Request(url, headers=headers)
    with urllib.request.urlopen(request) as response:
        data = json.loads(response.read().decode())
        tweets = []

        if 'data' in data:
            for tweet in data['data']:
                tweets.append({
                    'text': tweet['text'],
                    'id': tweet['id']
                })
        return tweets

def chat_box():
    print("Welcome to the Crime Post Fetcher (No 3rd Party Library Version)!")
    year_range = input("Enter the year range (example: 2019 to 2021): ")
    start_year, end_year = map(int, year_range.split("to"))

    print("\nFetching Twitter posts...")
    twitter_posts = fetch_twitter_crime_posts(start_year, end_year)
    print(f"Found {len(twitter_posts)} Twitter posts.")

    # Display results
    for post in twitter_posts:
        print(f"- {post['text']} (Tweet ID: {post['id']})")

if __name__ == "__main__":
    chat_box()
